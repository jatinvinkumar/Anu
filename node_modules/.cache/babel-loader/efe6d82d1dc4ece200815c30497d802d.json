{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.createFirestoreConnect = undefined;\n\nvar _filter2 = require('lodash/filter');\n\nvar _filter3 = _interopRequireDefault(_filter2);\n\nvar _some2 = require('lodash/some');\n\nvar _some3 = _interopRequireDefault(_some2);\n\nvar _isEqual2 = require('lodash/isEqual');\n\nvar _isEqual3 = _interopRequireDefault(_isEqual2);\n\nvar _extends = Object.assign || function (target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i];\n\n    for (var key in source) {\n      if (Object.prototype.hasOwnProperty.call(source, key)) {\n        target[key] = source[key];\n      }\n    }\n  }\n\n  return target;\n};\n\nvar _createClass = function () {\n  function defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  return function (Constructor, protoProps, staticProps) {\n    if (protoProps) defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) defineProperties(Constructor, staticProps);\n    return Constructor;\n  };\n}();\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _propTypes = require('prop-types');\n\nvar _propTypes2 = _interopRequireDefault(_propTypes);\n\nvar _hoistNonReactStatics = require('hoist-non-react-statics');\n\nvar _hoistNonReactStatics2 = _interopRequireDefault(_hoistNonReactStatics);\n\nvar _utils = require('./utils');\n\nvar _constants = require('./constants');\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (!self) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass);\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      enumerable: false,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;\n}\n\nvar createFirestoreConnect = exports.createFirestoreConnect = function createFirestoreConnect() {\n  var storeKey = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 'store';\n  return function () {\n    var dataOrFn = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n    return function (WrappedComponent) {\n      var FirestoreConnect = function (_Component) {\n        _inherits(FirestoreConnect, _Component);\n\n        function FirestoreConnect() {\n          var _ref;\n\n          var _temp, _this, _ret;\n\n          _classCallCheck(this, FirestoreConnect);\n\n          for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n            args[_key] = arguments[_key];\n          }\n\n          return _ret = (_temp = (_this = _possibleConstructorReturn(this, (_ref = FirestoreConnect.__proto__ || Object.getPrototypeOf(FirestoreConnect)).call.apply(_ref, [this].concat(args))), _this), _this.prevData = null, _this.store = _this.context[storeKey], _temp), _possibleConstructorReturn(_this, _ret);\n        }\n\n        _createClass(FirestoreConnect, [{\n          key: 'componentWillMount',\n          value: function componentWillMount() {\n            if (!this.context || !this.context[storeKey]) {\n              throw new Error(_constants.v3ErrorMessage);\n            }\n\n            var firestore = this.store.firestore;\n\n            if (this.firestoreIsEnabled) {\n              var inputAsFunc = (0, _utils.createCallable)(dataOrFn);\n              this.prevData = inputAsFunc(this.props, this.store);\n              firestore.setListeners(this.prevData);\n            }\n          }\n        }, {\n          key: 'componentWillUnmount',\n          value: function componentWillUnmount() {\n            var firestore = this.store.firestore;\n\n            if (this.firestoreIsEnabled && this.prevData) {\n              firestore.unsetListeners(this.prevData);\n            }\n          }\n        }, {\n          key: 'UNSAFE_componentWillReceiveProps',\n          value: function UNSAFE_componentWillReceiveProps(np) {\n            var firestore = this.store.firestore;\n            var inputAsFunc = (0, _utils.createCallable)(dataOrFn);\n            var data = inputAsFunc(np, this.store);\n\n            if (this.firestoreIsEnabled && !(0, _isEqual3.default)(data, this.prevData)) {\n              var changes = this.getChanges(data, this.prevData);\n              this.prevData = data;\n              firestore.unsetListeners(changes.removed);\n              firestore.setListeners(changes.added);\n            }\n          }\n        }, {\n          key: 'getChanges',\n          value: function getChanges() {\n            var data = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n            var prevData = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n            var result = {};\n            result.added = (0, _filter3.default)(data, function (d) {\n              return !(0, _some3.default)(prevData, function (p) {\n                return (0, _isEqual3.default)(d, p);\n              });\n            });\n            result.removed = (0, _filter3.default)(prevData, function (p) {\n              return !(0, _some3.default)(data, function (d) {\n                return (0, _isEqual3.default)(p, d);\n              });\n            });\n            return result;\n          }\n        }, {\n          key: 'render',\n          value: function render() {\n            var _store = this.store,\n                firebase = _store.firebase,\n                firestore = _store.firestore;\n\n            var newProps = _extends({}, this.props, {\n              firestore: firestore\n            });\n\n            if (firebase) {\n              newProps.firebase = _extends({}, firebase, firebase.helpers);\n            }\n\n            return _react2.default.createElement(WrappedComponent, newProps);\n          }\n        }, {\n          key: 'firestoreIsEnabled',\n          get: function get() {\n            return !!this.store.firestore;\n          }\n        }]);\n\n        return FirestoreConnect;\n      }(_react.Component);\n\n      FirestoreConnect.wrappedComponent = WrappedComponent;\n      FirestoreConnect.displayName = (0, _utils.wrapDisplayName)(WrappedComponent, 'FirestoreConnect');\n      FirestoreConnect.contextTypes = _defineProperty({}, storeKey, _propTypes2.default.object.isRequired);\n      return (0, _hoistNonReactStatics2.default)(FirestoreConnect, WrappedComponent);\n    };\n  };\n};\n\nexports.default = createFirestoreConnect();","map":{"version":3,"sources":["/Users/jatinkumar/Desktop/Anupuam/Anu/node_modules/react-redux-firebase/es/firestoreConnect.js"],"names":["Object","defineProperty","exports","value","createFirestoreConnect","undefined","_filter2","require","_filter3","_interopRequireDefault","_some2","_some3","_isEqual2","_isEqual3","_extends","assign","target","i","arguments","length","source","key","prototype","hasOwnProperty","call","_createClass","defineProperties","props","descriptor","enumerable","configurable","writable","Constructor","protoProps","staticProps","_react","_react2","_propTypes","_propTypes2","_hoistNonReactStatics","_hoistNonReactStatics2","_utils","_constants","obj","__esModule","default","_defineProperty","_classCallCheck","instance","TypeError","_possibleConstructorReturn","self","ReferenceError","_inherits","subClass","superClass","create","constructor","setPrototypeOf","__proto__","storeKey","dataOrFn","WrappedComponent","FirestoreConnect","_Component","_ref","_temp","_this","_ret","_len","args","Array","_key","getPrototypeOf","apply","concat","prevData","store","context","componentWillMount","Error","v3ErrorMessage","firestore","firestoreIsEnabled","inputAsFunc","createCallable","setListeners","componentWillUnmount","unsetListeners","UNSAFE_componentWillReceiveProps","np","data","changes","getChanges","removed","added","result","d","p","render","_store","firebase","newProps","helpers","createElement","get","Component","wrappedComponent","displayName","wrapDisplayName","contextTypes","object","isRequired"],"mappings":"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","sourcesContent":["'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.createFirestoreConnect = undefined;\n\nvar _filter2 = require('lodash/filter');\n\nvar _filter3 = _interopRequireDefault(_filter2);\n\nvar _some2 = require('lodash/some');\n\nvar _some3 = _interopRequireDefault(_some2);\n\nvar _isEqual2 = require('lodash/isEqual');\n\nvar _isEqual3 = _interopRequireDefault(_isEqual2);\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _propTypes = require('prop-types');\n\nvar _propTypes2 = _interopRequireDefault(_propTypes);\n\nvar _hoistNonReactStatics = require('hoist-non-react-statics');\n\nvar _hoistNonReactStatics2 = _interopRequireDefault(_hoistNonReactStatics);\n\nvar _utils = require('./utils');\n\nvar _constants = require('./constants');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar createFirestoreConnect = exports.createFirestoreConnect = function createFirestoreConnect() {\n  var storeKey = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 'store';\n  return function () {\n    var dataOrFn = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n    return function (WrappedComponent) {\n      var FirestoreConnect = function (_Component) {\n        _inherits(FirestoreConnect, _Component);\n\n        function FirestoreConnect() {\n          var _ref;\n\n          var _temp, _this, _ret;\n\n          _classCallCheck(this, FirestoreConnect);\n\n          for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n            args[_key] = arguments[_key];\n          }\n\n          return _ret = (_temp = (_this = _possibleConstructorReturn(this, (_ref = FirestoreConnect.__proto__ || Object.getPrototypeOf(FirestoreConnect)).call.apply(_ref, [this].concat(args))), _this), _this.prevData = null, _this.store = _this.context[storeKey], _temp), _possibleConstructorReturn(_this, _ret);\n        }\n\n        _createClass(FirestoreConnect, [{\n          key: 'componentWillMount',\n          value: function componentWillMount() {\n            if (!this.context || !this.context[storeKey]) {\n              throw new Error(_constants.v3ErrorMessage);\n            }\n            var firestore = this.store.firestore;\n\n            if (this.firestoreIsEnabled) {\n              var inputAsFunc = (0, _utils.createCallable)(dataOrFn);\n              this.prevData = inputAsFunc(this.props, this.store);\n\n              firestore.setListeners(this.prevData);\n            }\n          }\n        }, {\n          key: 'componentWillUnmount',\n          value: function componentWillUnmount() {\n            var firestore = this.store.firestore;\n\n            if (this.firestoreIsEnabled && this.prevData) {\n              firestore.unsetListeners(this.prevData);\n            }\n          }\n        }, {\n          key: 'UNSAFE_componentWillReceiveProps',\n          value: function UNSAFE_componentWillReceiveProps(np) {\n            var firestore = this.store.firestore;\n\n            var inputAsFunc = (0, _utils.createCallable)(dataOrFn);\n            var data = inputAsFunc(np, this.store);\n\n            if (this.firestoreIsEnabled && !(0, _isEqual3.default)(data, this.prevData)) {\n              var changes = this.getChanges(data, this.prevData);\n\n              this.prevData = data;\n\n              firestore.unsetListeners(changes.removed);\n\n              firestore.setListeners(changes.added);\n            }\n          }\n        }, {\n          key: 'getChanges',\n          value: function getChanges() {\n            var data = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n            var prevData = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n\n            var result = {};\n            result.added = (0, _filter3.default)(data, function (d) {\n              return !(0, _some3.default)(prevData, function (p) {\n                return (0, _isEqual3.default)(d, p);\n              });\n            });\n            result.removed = (0, _filter3.default)(prevData, function (p) {\n              return !(0, _some3.default)(data, function (d) {\n                return (0, _isEqual3.default)(p, d);\n              });\n            });\n            return result;\n          }\n        }, {\n          key: 'render',\n          value: function render() {\n            var _store = this.store,\n                firebase = _store.firebase,\n                firestore = _store.firestore;\n\n            var newProps = _extends({}, this.props, { firestore: firestore });\n            if (firebase) {\n              newProps.firebase = _extends({}, firebase, firebase.helpers);\n            }\n            return _react2.default.createElement(WrappedComponent, newProps);\n          }\n        }, {\n          key: 'firestoreIsEnabled',\n          get: function get() {\n            return !!this.store.firestore;\n          }\n        }]);\n\n        return FirestoreConnect;\n      }(_react.Component);\n\n      FirestoreConnect.wrappedComponent = WrappedComponent;\n      FirestoreConnect.displayName = (0, _utils.wrapDisplayName)(WrappedComponent, 'FirestoreConnect');\n      FirestoreConnect.contextTypes = _defineProperty({}, storeKey, _propTypes2.default.object.isRequired);\n\n\n      return (0, _hoistNonReactStatics2.default)(FirestoreConnect, WrappedComponent);\n    };\n  };\n};\n\nexports.default = createFirestoreConnect();"]},"metadata":{},"sourceType":"script"}